{"ast":null,"code":"import _asyncToGenerator from \"/home/xittz/Documentos/sa-bombeiros3/sa-bombeiros/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Pool as tPool, spawn, Worker, Transfer } from 'threads';\nconst defaultPoolSize = typeof navigator !== 'undefined' ? navigator.hardwareConcurrency : null;\n/**\n * @module pool\n */\n\n/**\n * Pool for workers to decode chunks of the images.\n */\n\nclass Pool {\n  /**\n   * @constructor\n   * @param {Number} size The size of the pool. Defaults to the number of CPUs\n   *                      available. When this parameter is `null` or 0, then the\n   *                      decoding will be done in the main thread.\n   * @param {Worker} worker The decoder worker, loaded and initialised. Enables\n   *                        loading the worker using worker-loader(or others) externally\n   *                        when using this library as a webpack dependency.\n   */\n  constructor(size = defaultPoolSize, worker = new Worker('./decoder.worker.js')) {\n    this.pool = tPool(() => spawn(worker), size);\n  }\n  /**\n   * Decode the given block of bytes with the set compression method.\n   * @param {ArrayBuffer} buffer the array buffer of bytes to decode.\n   * @returns {Promise.<ArrayBuffer>} the decoded result as a `Promise`\n   */\n\n\n  decode(fileDirectory, buffer) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise((resolve, reject) => {\n        _this.pool.queue( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (decode) {\n            try {\n              const data = yield decode(fileDirectory, Transfer(buffer));\n              resolve(data);\n            } catch (err) {\n              reject(err);\n            }\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      });\n    })();\n  }\n\n  destroy() {\n    this.pool.terminate(true);\n  }\n\n}\n\nexport default Pool;","map":{"version":3,"sources":["/home/xittz/Documentos/sa-bombeiros3/sa-bombeiros/node_modules/geotiff/src/pool.js"],"names":["Pool","tPool","spawn","Worker","Transfer","defaultPoolSize","navigator","hardwareConcurrency","constructor","size","worker","pool","decode","fileDirectory","buffer","Promise","resolve","reject","queue","data","err","destroy","terminate"],"mappings":";AAAA,SAASA,IAAI,IAAIC,KAAjB,EAAwBC,KAAxB,EAA+BC,MAA/B,EAAuCC,QAAvC,QAAuD,SAAvD;AAEA,MAAMC,eAAe,GAAG,OAAOC,SAAP,KAAqB,WAArB,GAAmCA,SAAS,CAACC,mBAA7C,GAAmE,IAA3F;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AACA,MAAMP,IAAN,CAAW;AACT;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEQ,EAAAA,WAAW,CAACC,IAAI,GAAGJ,eAAR,EAAyBK,MAAM,GAAG,IAAIP,MAAJ,CAAW,qBAAX,CAAlC,EAAqE;AAC9E,SAAKQ,IAAL,GAAYV,KAAK,CAAC,MAAMC,KAAK,CAACQ,MAAD,CAAZ,EAAsBD,IAAtB,CAAjB;AACD;AAED;AACF;AACA;AACA;AACA;;;AACQG,EAAAA,MAAM,CAACC,aAAD,EAAgBC,MAAhB,EAAwB;AAAA;;AAAA;AAClC,aAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,QAAA,KAAI,CAACN,IAAL,CAAUO,KAAV;AAAA,uCAAgB,WAAON,MAAP,EAAkB;AAChC,gBAAI;AACF,oBAAMO,IAAI,SAASP,MAAM,CAACC,aAAD,EAAgBT,QAAQ,CAACU,MAAD,CAAxB,CAAzB;AACAE,cAAAA,OAAO,CAACG,IAAD,CAAP;AACD,aAHD,CAGE,OAAOC,GAAP,EAAY;AACZH,cAAAA,MAAM,CAACG,GAAD,CAAN;AACD;AACF,WAPD;;AAAA;AAAA;AAAA;AAAA;AAQD,OATM,CAAP;AADkC;AAWnC;;AAEDC,EAAAA,OAAO,GAAG;AACR,SAAKV,IAAL,CAAUW,SAAV,CAAoB,IAApB;AACD;;AAlCQ;;AAqCX,eAAetB,IAAf","sourcesContent":["import { Pool as tPool, spawn, Worker, Transfer } from 'threads';\n\nconst defaultPoolSize = typeof navigator !== 'undefined' ? navigator.hardwareConcurrency : null;\n\n/**\n * @module pool\n */\n\n/**\n * Pool for workers to decode chunks of the images.\n */\nclass Pool {\n  /**\n   * @constructor\n   * @param {Number} size The size of the pool. Defaults to the number of CPUs\n   *                      available. When this parameter is `null` or 0, then the\n   *                      decoding will be done in the main thread.\n   * @param {Worker} worker The decoder worker, loaded and initialised. Enables\n   *                        loading the worker using worker-loader(or others) externally\n   *                        when using this library as a webpack dependency.\n   */\n  constructor(size = defaultPoolSize, worker = new Worker('./decoder.worker.js')) {\n    this.pool = tPool(() => spawn(worker), size);\n  }\n\n  /**\n   * Decode the given block of bytes with the set compression method.\n   * @param {ArrayBuffer} buffer the array buffer of bytes to decode.\n   * @returns {Promise.<ArrayBuffer>} the decoded result as a `Promise`\n   */\n  async decode(fileDirectory, buffer) {\n    return new Promise((resolve, reject) => {\n      this.pool.queue(async (decode) => {\n        try {\n          const data = await decode(fileDirectory, Transfer(buffer));\n          resolve(data);\n        } catch (err) {\n          reject(err);\n        }\n      });\n    });\n  }\n\n  destroy() {\n    this.pool.terminate(true);\n  }\n}\n\nexport default Pool;\n"]},"metadata":{},"sourceType":"module"}